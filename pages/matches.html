<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§¤ì¹­ - ì»¤í”¼CMD</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/terminal.css">
    <style>
        /* ë§¤ì¹­ í˜ì´ì§€ ì „ìš© ìŠ¤íƒ€ì¼ */
        .matches-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .match-actions {
            display: flex;
            justify-content: flex-end;
            gap: 5px;
            margin-top: 5px;
        }
        
        .filter-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #0f0;
            border-radius: 3px;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-width: 150px;
        }
        
        .filter-label {
            font-size: 12px;
            color: #999;
            margin-bottom: 3px;
        }
        
        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .match-action-btn {
            background-color: transparent;
            color: #0f0;
            border: 1px solid #0f0;
            padding: 2px 6px;
            font-size: 12px;
            cursor: pointer;
            border-radius: 3px;
        }
        
        .match-action-btn:hover {
            background-color: #003300;
        }
        
        .match-action-btn.accept {
            background-color: #006600;
        }
        
        .match-action-btn.reject {
            color: #ff6666;
            border-color: #ff6666;
        }
        
        .match-action-btn.reject:hover {
            background-color: #330000;
        }
        
        .match-status {
            display: inline-block;
            padding: 2px 6px;
            font-size: 12px;
            border-radius: 3px;
            margin-top: 5px;
        }
        
        .match-status.pending {
            background-color: #333;
            color: #ff9900;
            border: 1px solid #ff9900;
        }
        
        .match-status.accepted {
            background-color: #060;
            color: #fff;
        }
        
        .match-status.scheduled {
            background-color: #006699;
            color: #fff;
        }
        
        .match-status.completed {
            background-color: #339933;
            color: #fff;
        }
        
        .match-status.rejected {
            background-color: #330000;
            color: #ff6666;
        }
        
        .badge.selected {
            background-color: #006600;
        }
    </style>
</head>
<body>
    <div class="terminal-screen">
        <div class="message system-message">ë§¤ì¹­ ê´€ë¦¬ í™”ë©´ì…ë‹ˆë‹¤. ê´€ì‹¬ì‚¬ë‚˜ ì§ì—…ì„ ê¸°ë°˜ìœ¼ë¡œ ë§¤ì¹­ëœ ì‚¬ìš©ì ëª©ë¡ì…ë‹ˆë‹¤.</div>
        
        <div class="filter-bar">
            <div class="filter-group">
                <div class="filter-label">ì§ì—…êµ°</div>
                <div class="filter-options">
                    <span class="badge selected" data-filter="job" data-value="all">ì „ì²´</span>
                    <span class="badge" data-filter="job" data-value="ê°œë°œì">ê°œë°œì</span>
                    <span class="badge" data-filter="job" data-value="ë””ìì´ë„ˆ">ë””ìì´ë„ˆ</span>
                    <span class="badge" data-filter="job" data-value="ë§ˆì¼€í„°">ë§ˆì¼€í„°</span>
                    <span class="badge" data-filter="job" data-value="ê¸°íšì">ê¸°íšì</span>
                </div>
            </div>
            
            <div class="filter-group">
                <div class="filter-label">ì§€ì—­</div>
                <div class="filter-options">
                    <span class="badge selected" data-filter="location" data-value="all">ì „ì²´</span>
                    <span class="badge" data-filter="location" data-value="ê°•ë‚¨">ê°•ë‚¨</span>
                    <span class="badge" data-filter="location" data-value="íŒêµ">íŒêµ</span>
                    <span class="badge" data-filter="location" data-value="í™ëŒ€">í™ëŒ€</span>
                    <span class="badge" data-filter="location" data-value="ì„±ìˆ˜">ì„±ìˆ˜</span>
                </div>
            </div>
            
            <div class="filter-group">
                <div class="filter-label">ìƒíƒœ</div>
                <div class="filter-options">
                    <span class="badge selected" data-filter="status" data-value="all">ì „ì²´</span>
                    <span class="badge" data-filter="status" data-value="pending">ëŒ€ê¸°ì¤‘</span>
                    <span class="badge" data-filter="status" data-value="accepted">ìˆ˜ë½ë¨</span>
                    <span class="badge" data-filter="status" data-value="scheduled">ì˜ˆì •ë¨</span>
                    <span class="badge" data-filter="status" data-value="completed">ì™„ë£Œë¨</span>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">ìƒˆë¡œìš´ ë§¤ì¹­</div>
            <div class="matches-container" id="new-matches">
                <div class="match-item" data-id="user1" data-job="ë””ìì´ë„ˆ" data-location="ê°•ë‚¨" data-status="pending">
                    <div class="match-info">
                        <span class="match-name">ë°•ë””ìì´ë„ˆ</span>
                        <span class="match-job">UX/UI ë””ìì´ë„ˆ</span>
                    </div>
                    <div class="match-interests">ê´€ì‹¬ì‚¬: ì›¹ë””ìì¸, ì‚¬ìš©ìê²½í—˜, ë¯¸ë‹ˆë©€ë¦¬ì¦˜, ì»¤í”¼</div>
                    <div class="match-location">ì§€ì—­: ì„œìš¸ ê°•ë‚¨êµ¬</div>
                    <div class="match-rating">â­ ì¼ì¹˜ë„: 89%</div>
                    <div class="match-status pending">ëŒ€ê¸°ì¤‘</div>
                    <div class="match-actions">
                        <button class="match-action-btn accept" data-action="accept" data-id="user1">ìˆ˜ë½</button>
                        <button class="match-action-btn reject" data-action="reject" data-id="user1">ê±°ì ˆ</button>
                        <button class="match-action-btn" data-action="chat" data-id="user1">ë©”ì‹œì§€</button>
                    </div>
                </div>
                
                <div class="match-item" data-id="user2" data-job="ê°œë°œì" data-location="ì†¡íŒŒ" data-status="pending">
                    <div class="match-info">
                        <span class="match-name">ê¹€ê°œë°œ</span>
                        <span class="match-job">í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì</span>
                    </div>
                    <div class="match-interests">ê´€ì‹¬ì‚¬: React, ë””ìì¸ì‹œìŠ¤í…œ, ì˜¤í”ˆì†ŒìŠ¤, ë§¥ì£¼</div>
                    <div class="match-location">ì§€ì—­: ì„œìš¸ ì†¡íŒŒêµ¬</div>
                    <div class="match-rating">â­ ì¼ì¹˜ë„: 75%</div>
                    <div class="match-status pending">ëŒ€ê¸°ì¤‘</div>
                    <div class="match-actions">
                        <button class="match-action-btn accept" data-action="accept" data-id="user2">ìˆ˜ë½</button>
                        <button class="match-action-btn reject" data-action="reject" data-id="user2">ê±°ì ˆ</button>
                        <button class="match-action-btn" data-action="chat" data-id="user2">ë©”ì‹œì§€</button>
                    </div>
                </div>
                
                <div class="match-item" data-id="user3" data-job="ê¸°íšì" data-location="ì„œì´ˆ" data-status="pending">
                    <div class="match-info">
                        <span class="match-name">ì´ì°½ì—…</span>
                        <span class="match-job">ìŠ¤íƒ€íŠ¸ì—… ëŒ€í‘œ</span>
                    </div>
                    <div class="match-interests">ê´€ì‹¬ì‚¬: AI, íˆ¬ììœ ì¹˜, ì œí’ˆê¸°íš, ì™€ì¸</div>
                    <div class="match-location">ì§€ì—­: ì„œìš¸ ì„œì´ˆêµ¬</div>
                    <div class="match-rating">â­ ì¼ì¹˜ë„: 65%</div>
                    <div class="match-status pending">ëŒ€ê¸°ì¤‘</div>
                    <div class="match-actions">
                        <button class="match-action-btn accept" data-action="accept" data-id="user3">ìˆ˜ë½</button>
                        <button class="match-action-btn reject" data-action="reject" data-id="user3">ê±°ì ˆ</button>
                        <button class="match-action-btn" data-action="chat" data-id="user3">ë©”ì‹œì§€</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">ì§„í–‰ ì¤‘ì¸ ë§¤ì¹­</div>
            <div class="matches-container" id="active-matches">
                <div class="match-item" data-id="user4" data-job="ë§ˆì¼€í„°" data-location="ë§ˆí¬" data-status="accepted">
                    <div class="match-info">
                        <span class="match-name">ìµœë§ˆì¼€í„°</span>
                        <span class="match-job">ë””ì§€í„¸ ë§ˆì¼€í„°</span>
                    </div>
                    <div class="match-interests">ê´€ì‹¬ì‚¬: SNSë§ˆì¼€íŒ…, ì½˜í…ì¸ ì œì‘, ë¸Œëœë”©, ë‹¤ì´ì–´ë¦¬</div>
                    <div class="match-location">ì§€ì—­: ì„œìš¸ ë§ˆí¬êµ¬</div>
                    <div class="match-status accepted">ìˆ˜ë½ë¨</div>
                    <div class="match-actions">
                        <button class="match-action-btn" data-action="schedule" data-id="user4">ì¼ì • ì¡ê¸°</button>
                        <button class="match-action-btn" data-action="chat" data-id="user4">ë©”ì‹œì§€</button>
                    </div>
                </div>
                
                <div class="match-item" data-id="user5" data-job="ë””ìì´ë„ˆ" data-location="ì„±ìˆ˜" data-status="scheduled">
                    <div class="match-info">
                        <span class="match-name">ì •UX</span>
                        <span class="match-job">UX ë¦¬ì„œì²˜</span>
                    </div>
                    <div class="match-interests">ê´€ì‹¬ì‚¬: ì‚¬ìš©ì ë¦¬ì„œì¹˜, ì¸í„°ë™ì…˜ ë””ìì¸, ì‹¬ë¦¬í•™, ì°¨</div>
                    <div class="match-location">ì§€ì—­: ì„œìš¸ ì„±ë™êµ¬</div>
                    <div class="match-status scheduled">ğŸ“… 2025-03-05 16:00</div>
                    <div class="match-actions">
                        <button class="match-action-btn" data-action="reschedule" data-id="user5">ì¼ì • ë³€ê²½</button>
                        <button class="match-action-btn" data-action="chat" data-id="user5">ë©”ì‹œì§€</button>
                        <button class="match-action-btn" data-action="complete" data-id="user5">ì™„ë£Œ</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">ì™„ë£Œëœ ë§¤ì¹­</div>
            <div class="matches-container" id="completed-matches">
                <div class="match-item" data-id="user6" data-job="ê°œë°œì" data-location="ê°•ë‚¨" data-status="completed">
                    <div class="match-info">
                        <span class="match-name">ë°•í’€ìŠ¤íƒ</span>
                        <span class="match-job">í’€ìŠ¤íƒ ê°œë°œì</span>
                    </div>
                    <div class="match-interests">ê´€ì‹¬ì‚¬: Node.js, React, MongoDB, í´ë¼ìš°ë“œ</div>
                    <div class="match-location">ì§€ì—­: ì„œìš¸ ê°•ë‚¨êµ¬</div>
                    <div class="match-status completed">âœ… 2025-02-20 ì™„ë£Œ</div>
                    <div class="match-actions">
                        <button class="match-action-btn" data-action="review" data-id="user6">í›„ê¸° ì‘ì„±</button>
                        <button class="match-action-btn" data-action="chat" data-id="user6">ë©”ì‹œì§€</button>
                    </div>
                </div>
                
                <div class="match-item" data-id="user7" data-job="ê¸°íšì" data-location="íŒêµ" data-status="completed">
                    <div class="match-info">
                        <span class="match-name">ê¹€PM</span>
                        <span class="match-job">ì œí’ˆ ê´€ë¦¬ì</span>
                    </div>
                    <div class="match-interests">ê´€ì‹¬ì‚¬: ì• ìì¼, ìŠ¤í¬ëŸ¼, ì œí’ˆ ì „ëµ, ë§¥ì£¼</div>
                    <div class="match-location">ì§€ì—­: ê²½ê¸° íŒêµ</div>
                    <div class="match-status completed">âœ… 2025-02-12 ì™„ë£Œ</div>
                    <div class="match-actions">
                        <button class="match-action-btn" data-action="review" data-id="user7">í›„ê¸° ì‘ì„±</button>
                        <button class="match-action-btn" data-action="chat" data-id="user7">ë©”ì‹œì§€</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="input-line">
            <span class="prompt">ë§¤ì¹­></span>
            <input type="text" class="command-input" id="commandInput" placeholder="'ë§¤ì¹˜ [ì°¾ì„ ì‚¬ëŒ í‚¤ì›Œë“œ]' ëª…ë ¹ì–´ë¡œ ìƒˆ ë§¤ì¹­ì„ ì°¾ìœ¼ì„¸ìš”">
            <button class="command-button" id="searchButton">ê²€ìƒ‰</button>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const commandInput = document.getElementById('commandInput');
            const searchButton = document.getElementById('searchButton');
            
            // í•„í„° ì´ë²¤íŠ¸ ì²˜ë¦¬
            setupFilters();
            
            // ë§¤ì¹­ ì•¡ì…˜ ë²„íŠ¼ ì´ë²¤íŠ¸ ì²˜ë¦¬
            setupMatchActions();
            
            // ëª…ë ¹ì–´ ì…ë ¥ ì²˜ë¦¬
            commandInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    processCommand(this.value);
                    this.value = '';
                }
            });
            
            searchButton.addEventListener('click', function() {
                processCommand(commandInput.value);
                commandInput.value = '';
            });
            
            // í•„í„° ì„¤ì •
            function setupFilters() {
                const filterBadges = document.querySelectorAll('.badge[data-filter]');
                
                filterBadges.forEach(badge => {
                    badge.addEventListener('click', function() {
                        const filterType = this.getAttribute('data-filter');
                        const filterValue = this.getAttribute('data-value');
                        
                        // ê°™ì€ í•„í„° ê·¸ë£¹ì—ì„œ ì„ íƒëœ ë±ƒì§€ ë³€ê²½
                        document.querySelectorAll(`.badge[data-filter="${filterType}"]`).forEach(b => {
                            b.classList.remove('selected');
                        });
                        
                        this.classList.add('selected');
                        
                        // í•„í„° ì ìš©
                        applyFilters();
                    });
                });
            }
            
            // í•„í„° ì ìš©
            function applyFilters() {
                const jobFilter = document.querySelector('.badge.selected[data-filter="job"]').getAttribute('data-value');
                const locationFilter = document.querySelector('.badge.selected[data-filter="location"]').getAttribute('data-value');
                const statusFilter = document.querySelector('.badge.selected[data-filter="status"]').getAttribute('data-value');
                
                const allMatches = document.querySelectorAll('.match-item');
                
                allMatches.forEach(match => {
                    const matchJob = match.getAttribute('data-job');
                    const matchLocation = match.getAttribute('data-location');
                    const matchStatus = match.getAttribute('data-status');
                    
                    let visible = true;
                    
                    if (jobFilter !== 'all' && !matchJob.includes(jobFilter)) {
                        visible = false;
                    }
                    
                    if (locationFilter !== 'all' && !matchLocation.includes(locationFilter)) {
                        visible = false;
                    }
                    
                    if (statusFilter !== 'all' && matchStatus !== statusFilter) {
                        visible = false;
                    }
                    
                    match.style.display = visible ? 'block' : 'none';
                });
            }
            
            // ë§¤ì¹­ ì•¡ì…˜ ë²„íŠ¼ ì„¤ì •
            function setupMatchActions() {
                const actionButtons = document.querySelectorAll('.match-action-btn');
                
                actionButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const action = this.getAttribute('data-action');
                        const userId = this.getAttribute('data-id');
                        const matchItem = document.querySelector(`.match-item[data-id="${userId}"]`);
                        const userName = matchItem.querySelector('.match-name').textContent;
                        
                        switch (action) {
                            case 'accept':
                                acceptMatch(userId, userName, matchItem);
                                break;
                                
                            case 'reject':
                                rejectMatch(userId, userName, matchItem);
                                break;
                                
                            case 'chat':
                                openChat(userId, userName);
                                break;
                                
                            case 'schedule':
                                scheduleMatch(userId, userName, matchItem);
                                break;
                                
                            case 'reschedule':
                                rescheduleMatch(userId, userName);
                                break;
                                
                            case 'complete':
                                completeMatch(userId, userName, matchItem);
                                break;
                                
                            case 'review':
                                writeReview(userId, userName);
                                break;
                        }
                    });
                });
            }
            
            // ë§¤ì¹­ ìˆ˜ë½
            function acceptMatch(userId, userName, matchItem) {
                window.parent.postMessage({
                    action: 'notification',
                    text: `${userName}ë‹˜ì˜ ë§¤ì¹­ ìš”ì²­ì„ ìˆ˜ë½í–ˆìŠµë‹ˆë‹¤.`,
                    type: 'success'
                }, '*');
                
                // ìƒíƒœ ì—…ë°ì´íŠ¸
                matchItem.setAttribute('data-status', 'accepted');
                const statusDiv = matchItem.querySelector('.match-status');
                statusDiv.textContent = 'ìˆ˜ë½ë¨';
                statusDiv.className = 'match-status accepted';
                
                // ë²„íŠ¼ ì—…ë°ì´íŠ¸
                matchItem.querySelector('.match-actions').innerHTML = `
                    <button class="match-action-btn" data-action="schedule" data-id="${userId}">ì¼ì • ì¡ê¸°</button>
                    <button class="match-action-btn" data-action="chat" data-id="${userId}">ë©”ì‹œì§€</button>
                `;
                
                // ëª©ë¡ ì´ë™
                document.getElementById('active-matches').appendChild(matchItem);
                
                // ë²„íŠ¼ ì´ë²¤íŠ¸ ë‹¤ì‹œ ì„¤ì •
                setupMatchActions();
            }
            
            // ë§¤ì¹­ ê±°ì ˆ
            function rejectMatch(userId, userName, matchItem) {
                const confirmed = confirm(`${userName}ë‹˜ì˜ ë§¤ì¹­ ìš”ì²­ì„ ê±°ì ˆí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`);
                
                if (confirmed) {
                    window.parent.postMessage({
                        action: 'notification',
                        text: `${userName}ë‹˜ì˜ ë§¤ì¹­ ìš”ì²­ì„ ê±°ì ˆí–ˆìŠµë‹ˆë‹¤.`,
                        type: 'info'
                    }, '*');
                    
                    matchItem.remove();
                }
            }
            
            // ì±„íŒ… ì—´ê¸°
            function openChat(userId, userName) {
                window.parent.postMessage({
                    action: 'notification',
                    text: `${userName}ë‹˜ê³¼ì˜ ì±„íŒ…ì„ ì‹œì‘í•©ë‹ˆë‹¤.`,
                    type: 'info'
                }, '*');
                
                // ì±„íŒ… í˜ì´ì§€ë¡œ ì´ë™
                window.parent.postMessage({
                    action: 'navigate',
                    screen: 'chat'
                }, '*');
                
                // í•´ë‹¹ ì‚¬ìš©ì ë°ì´í„° ì „ë‹¬ (ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥)
                sessionStorage.setItem('currentChatUser', JSON.stringify({
                    id: userId,
                    name: userName
                }));
            }
            
            // ì¼ì • ì¡ê¸°
            function scheduleMatch(userId, userName, matchItem) {
                const dateTimeContent = `
                    <div class="form-group">
                        <label class="form-label">ë‚ ì§œ</label>
                        <input type="date" class="form-input" id="scheduleDate" min="${new Date().toISOString().split('T')[0]}">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì‹œê°„</label>
                        <input type="time" class="form-input" id="scheduleTime">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì¥ì†Œ</label>
                        <select class="form-select" id="scheduleLocation">
                            <option value="ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì ">ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì </option>
                            <option value="ì¹´í˜ ê³µëª…">ì¹´í˜ ê³µëª…</option>
                            <option value="ì¹´í˜ ë…¸ë§ˆë“œ">ì¹´í˜ ë…¸ë§ˆë“œ</option>
                            <option value="ë¸”ë£¨ë³´í‹€ ì„±ìˆ˜ì ">ë¸”ë£¨ë³´í‹€ ì„±ìˆ˜ì </option>
                            <option value="ì§ì ‘ ì…ë ¥">ì§ì ‘ ì…ë ¥</option>
                        </select>
                    </div>
                    <div class="form-group" id="customLocationGroup" style="display: none;">
                        <label class="form-label">ì§ì ‘ ì…ë ¥</label>
                        <input type="text" class="form-input" id="customLocation">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ë©”ëª¨</label>
                        <textarea class="form-textarea" id="scheduleMemo" placeholder="ë©”ëª¨ ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”."></textarea>
                    </div>
                `;
                
                window.parent.postMessage({
                    action: 'openModal',
                    title: `${userName}ë‹˜ê³¼ ì¼ì • ì¡ê¸°`,
                    content: dateTimeContent,
                    buttons: [
                        {
                            text: 'í™•ì¸',
                            action: function() {
                                const date = document.getElementById('scheduleDate').value;
                                const time = document.getElementById('scheduleTime').value;
                                
                                if (!date || !time) {
                                    alert('ë‚ ì§œì™€ ì‹œê°„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                                    return false;
                                }
                                
                                const locationSelect = document.getElementById('scheduleLocation');
                                let location = locationSelect.value;
                                
                                if (location === 'ì§ì ‘ ì…ë ¥') {
                                    location = document.getElementById('customLocation').value;
                                }
                                
                                const memo = document.getElementById('scheduleMemo').value;
                                
                                // ìƒíƒœ ì—…ë°ì´íŠ¸
                                matchItem.setAttribute('data-status', 'scheduled');
                                const statusDiv = matchItem.querySelector('.match-status');
                                statusDiv.textContent = `ğŸ“… ${date} ${time}`;
                                statusDiv.className = 'match-status scheduled';
                                
                                // ë²„íŠ¼ ì—…ë°ì´íŠ¸
                                matchItem.querySelector('.match-actions').innerHTML = `
                                    <button class="match-action-btn" data-action="reschedule" data-id="${userId}">ì¼ì • ë³€ê²½</button>
                                    <button class="match-action-btn" data-action="chat" data-id="${userId}">ë©”ì‹œì§€</button>
                                    <button class="match-action-btn" data-action="complete" data-id="${userId}">ì™„ë£Œ</button>
                                `;
                                
                                // ë²„íŠ¼ ì´ë²¤íŠ¸ ë‹¤ì‹œ ì„¤ì •
                                setupMatchActions();
                                
                                window.parent.postMessage({
                                    action: 'notification',
                                    text: `${userName}ë‹˜ê³¼ì˜ ì¼ì •ì´ ${date} ${time}ì— ì¡í˜”ìŠµë‹ˆë‹¤.`,
                                    type: 'success'
                                }, '*');
                            }
                        },
                        {
                            text: 'ì·¨ì†Œ',
                            type: 'cancel'
                        }
                    ]
                }, '*');
                
                // ì§ì ‘ ì…ë ¥ ì„ íƒ ì‹œ ì¶”ê°€ í•„ë“œ í‘œì‹œ
                setTimeout(() => {
                    const locationSelect = document.getElementById('scheduleLocation');
                    const customLocationGroup = document.getElementById('customLocationGroup');
                    
                    locationSelect.addEventListener('change', function() {
                        if (this.value === 'ì§ì ‘ ì…ë ¥') {
                            customLocationGroup.style.display = 'block';
                        } else {
                            customLocationGroup.style.display = 'none';
                        }
                    });
                }, 100);
            }
            
            // ì¼ì • ë³€ê²½
            function rescheduleMatch(userId, userName) {
                window.parent.postMessage({
                    action: 'notification',
                    text: `${userName}ë‹˜ê³¼ì˜ ì¼ì • ë³€ê²½ì€ ë©”ì‹œì§€ë¥¼ í†µí•´ ìƒì˜í•´ì£¼ì„¸ìš”.`,
                    type: 'info'
                }, '*');
            }
            
            // ë§¤ì¹­ ì™„ë£Œ
            function completeMatch(userId, userName, matchItem) {
                const confirmed = confirm(`${userName}ë‹˜ê³¼ì˜ ì»¤í”¼ì±— ë¯¸íŒ…ì„ ì™„ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`);
                
                if (confirmed) {
                    // ìƒíƒœ ì—…ë°ì´íŠ¸
                    matchItem.setAttribute('data-status', 'completed');
                    const statusDiv = matchItem.querySelector('.match-status');
                    statusDiv.textContent = `âœ… ${new Date().toISOString().split('T')[0]} ì™„ë£Œ`;
                    statusDiv.className = 'match-status completed';
                    
                    // ë²„íŠ¼ ì—…ë°ì´íŠ¸
                    matchItem.querySelector('.match-actions').innerHTML = `
                        <button class="match-action-btn" data-action="review" data-id="${userId}">í›„ê¸° ì‘ì„±</button>
                        <button class="match-action-btn" data-action="chat" data-id="${userId}">ë©”ì‹œì§€</button>
                    `;
                    
                    // ëª©ë¡ ì´ë™
                    document.getElementById('completed-matches').appendChild(matchItem);
                    
                    // ë²„íŠ¼ ì´ë²¤íŠ¸ ë‹¤ì‹œ ì„¤ì •
                    setupMatchActions();
                    
                    window.parent.postMessage({
                        action: 'notification',
                        text: `${userName}ë‹˜ê³¼ì˜ ì»¤í”¼ì±— ë¯¸íŒ…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. í›„ê¸°ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”.`,
                        type: 'success'
                    }, '*');
                    
                    // ê²½í—˜ì¹˜ íšë“
                    window.parent.postMessage({
                        action: 'updateUser',
                        userData: {
                            exp: 100,
                            points: 20
                        }
                    }, '*');
                }
            }
            
            // í›„ê¸° ì‘ì„±
            function writeReview(userId, userName) {
                const reviewContent = `
                    <div class="form-group">
                        <label class="form-label">í‰ì </label>
                        <select class="form-select" id="reviewRating">
                            <option value="5">â˜…â˜…â˜…â˜…â˜… ë§¤ìš° ì¢‹ì•˜ì–´ìš”</option>
                            <option value="4">â˜…â˜…â˜…â˜…â˜† ì¢‹ì•˜ì–´ìš”</option>
                            <option value="3">â˜…â˜…â˜…â˜†â˜† ë³´í†µì´ì—ìš”</option>
                            <option value="2">â˜…â˜…â˜†â˜†â˜† ì•„ì‰¬ì› ì–´ìš”</option>
                            <option value="1">â˜…â˜†â˜†â˜†â˜† ë³„ë¡œì˜€ì–´ìš”</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">í›„ê¸° ë‚´ìš©</label>
                        <textarea class="form-textarea" id="reviewContent" placeholder="ë§Œë‚¨ì— ëŒ€í•œ í›„ê¸°ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ê³µê°œ ì—¬ë¶€</label>
                        <select class="form-select" id="reviewPublic">
                            <option value="public">ê³µê°œ (ì»¤ë®¤ë‹ˆí‹°ì— ê³µìœ )</option>
                            <option value="private">ë¹„ê³µê°œ (ìƒëŒ€ë°©ì—ê²Œë§Œ ê³µìœ )</option>
                        </select>
                    </div>
                `;
                
                window.parent.postMessage({
                    action: 'openModal',
                    title: `${userName}ë‹˜ì— ëŒ€í•œ í›„ê¸° ì‘ì„±`,
                    content: reviewContent,
                    buttons: [
                        {
                            text: 'ì œì¶œ',
                            action: function() {
                                const rating = document.getElementById('reviewRating').value;
                                const content = document.getElementById('reviewContent').value;
                                
                                if (!content) {
                                    alert('í›„ê¸° ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                                    return false;
                                }window.parent.postMessage({
                                    action: 'notification',
                                    text: `${userName}ë‹˜ì— ëŒ€í•œ í›„ê¸°ë¥¼ ì‘ì„±í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.`,
                                    type: 'success'
                                }, '*');
                                
                                // ê²½í—˜ì¹˜ íšë“
                                window.parent.postMessage({
                                    action: 'updateUser',
                                    userData: {
                                        exp: 50,
                                        points: 10
                                    }
                                }, '*');
                            }
                        },
                        {
                            text: 'ì·¨ì†Œ',
                            type: 'cancel'
                        }
                    ]
                }, '*');
            }
            
            // ëª…ë ¹ì–´ ì²˜ë¦¬
            function processCommand(command) {
                if (!command.trim()) return;
                
                const commandLower = command.toLowerCase().trim();
                
                if (commandLower.startsWith('ë§¤ì¹˜ ') || commandLower.startsWith('match ')) {
                    const keyword = commandLower.split(' ')[1];
                    searchMatch(keyword);
                } else if (commandLower === 'refresh' || commandLower === 'ìƒˆë¡œê³ ì¹¨') {
                    location.reload();
                } else if (commandLower.startsWith('ìˆ˜ë½ ') || commandLower.startsWith('accept ')) {
                    const userId = commandLower.split(' ')[1];
                    const matchItem = document.querySelector(`.match-item[data-id="${userId}"]`);
                    if (matchItem) {
                        const userName = matchItem.querySelector('.match-name').textContent;
                        acceptMatch(userId, userName, matchItem);
                    } else {
                        window.parent.postMessage({
                            action: 'notification',
                            text: `ì‚¬ìš©ì ID "${userId}"ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,
                            type: 'error'
                        }, '*');
                    }
                } else if (commandLower.startsWith('ê±°ì ˆ ') || commandLower.startsWith('reject ')) {
                    const userId = commandLower.split(' ')[1];
                    const matchItem = document.querySelector(`.match-item[data-id="${userId}"]`);
                    if (matchItem) {
                        const userName = matchItem.querySelector('.match-name').textContent;
                        rejectMatch(userId, userName, matchItem);
                    } else {
                        window.parent.postMessage({
                            action: 'notification',
                            text: `ì‚¬ìš©ì ID "${userId}"ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,
                            type: 'error'
                        }, '*');
                    }
                } else if (commandLower.startsWith('ì±„íŒ… ') || commandLower.startsWith('chat ')) {
                    const userId = commandLower.split(' ')[1];
                    const matchItem = document.querySelector(`.match-item[data-id="${userId}"]`);
                    if (matchItem) {
                        const userName = matchItem.querySelector('.match-name').textContent;
                        openChat(userId, userName);
                    } else {
                        window.parent.postMessage({
                            action: 'notification',
                            text: `ì‚¬ìš©ì ID "${userId}"ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,
                            type: 'error'
                        }, '*');
                    }
                } else if (commandLower.startsWith('ì¼ì • ') || commandLower.startsWith('schedule ')) {
                    const parts = commandLower.split(' ');
                    if (parts.length < 2) {
                        window.parent.postMessage({
                            action: 'notification',
                            text: `ëª…ë ¹ì–´ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. 'ì¼ì • [ID]' í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.`,
                            type: 'error'
                        }, '*');
                        return;
                    }
                    
                    const userId = parts[1];
                    const matchItem = document.querySelector(`.match-item[data-id="${userId}"]`);
                    if (matchItem) {
                        const userName = matchItem.querySelector('.match-name').textContent;
                        scheduleMatch(userId, userName, matchItem);
                    } else {
                        window.parent.postMessage({
                            action: 'notification',
                            text: `ì‚¬ìš©ì ID "${userId}"ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,
                            type: 'error'
                        }, '*');
                    }
                } else if (commandLower === 'help' || commandLower === 'ë„ì›€ë§') {
                    showHelp();
                } else {
                    window.parent.postMessage({
                        action: 'notification',
                        text: `'${command}' ëª…ë ¹ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. 'help'ë¥¼ ì…ë ¥í•˜ì—¬ ë„ì›€ë§ì„ í™•ì¸í•˜ì„¸ìš”.`,
                        type: 'error'
                    }, '*');
                }
            }
            
            // ë§¤ì¹­ ê²€ìƒ‰
            function searchMatch(keyword) {
                if (!keyword) {
                    window.parent.postMessage({
                        action: 'notification',
                        text: 'ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.',
                        type: 'error'
                    }, '*');
                    return;
                }
                
                // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” API í˜¸ì¶œì„ í†µí•´ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜´
                // ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•œ ì‹œë®¬ë ˆì´ì…˜ë§Œ êµ¬í˜„
                window.parent.postMessage({
                    action: 'notification',
                    text: `"${keyword}" í‚¤ì›Œë“œë¡œ ê²€ìƒ‰ ì¤‘...`,
                    type: 'info'
                }, '*');
                
                // ë¡œë”© ì‹œë®¬ë ˆì´ì…˜
                setTimeout(() => {
                    // ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ ì‹œë®¬ë ˆì´ì…˜
                    window.parent.postMessage({
                        action: 'notification',
                        text: `"${keyword}" í‚¤ì›Œë“œì— ë§ëŠ” ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,
                        type: 'error'
                    }, '*');
                }, 1500);
            }
            
            // ë„ì›€ë§ í‘œì‹œ
            function showHelp() {
                const helpContent = `
                    <div class="message">- <span style="color: yellow;">ë§¤ì¹˜ [í‚¤ì›Œë“œ]</span>: íŠ¹ì • í‚¤ì›Œë“œë¡œ ì‚¬ìš©ì ê²€ìƒ‰</div>
                    <div class="message">- <span style="color: yellow;">ìˆ˜ë½ [ID]</span>: ë§¤ì¹­ ìš”ì²­ ìˆ˜ë½</div>
                    <div class="message">- <span style="color: yellow;">ê±°ì ˆ [ID]</span>: ë§¤ì¹­ ìš”ì²­ ê±°ì ˆ</div>
                    <div class="message">- <span style="color: yellow;">ì±„íŒ… [ID]</span>: ì‚¬ìš©ìì™€ ì±„íŒ… ì‹œì‘</div>
                    <div class="message">- <span style="color: yellow;">ì¼ì • [ID]</span>: ë¯¸íŒ… ì¼ì • ì„¤ì •</div>
                    <div class="message">- <span style="color: yellow;">ìƒˆë¡œê³ ì¹¨</span>: í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨</div>
                `;
                
                window.parent.postMessage({
                    action: 'openModal',
                    title: 'ë§¤ì¹­ ëª…ë ¹ì–´ ë„ì›€ë§',
                    content: helpContent,
                    buttons: [
                        {
                            text: 'í™•ì¸'
                        }
                    ]
                }, '*');
            }
        });
    </script>
</body>
</html>